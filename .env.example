# K-BAAS-2 Environment Variables
# Copy this file to .env and fill in your values
#
# For development: cp .env.example .env
# For production:  cp .env.example .env.production (then set production values)
#
# ⚠️  NEVER commit .env to git! It contains secrets.
# ✓  .env.production can be committed (without secrets) for production defaults.

# =============================================================================
# DOCKER COMPOSE PORT MAPPINGS
# These variables are used by Docker Compose for port mapping on the host machine
# =============================================================================
FRONTEND_PORT=6166
BACKEND_PORT=6616
TYPEDB_PORT=1729
TYPEDB_HTTP_PORT=1728
AUTHENTIK_PORT_HTTP=9000
AUTHENTIK_PORT_HTTPS=9443

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_ENV=development
DEBUG=true

# =============================================================================
# BACKEND CONFIGURATION
# =============================================================================
BACKEND_HOST=0.0.0.0

# =============================================================================
# FRONTEND CONFIGURATION
# Vite requires VITE_ prefix for environment variables to be exposed to the browser
# =============================================================================
VITE_BACKEND_URL=http://localhost:6616

# =============================================================================
# TYPEDB DATABASE
# =============================================================================
# In Docker: TYPEDB_HOST=typedb (container hostname)
# Outside Docker: TYPEDB_HOST=127.0.0.1 (localhost)
TYPEDB_HOST=typedb

# Database initialization settings
TYPEDB_DATABASE_NAME=kennisbaas
TYPEDB_SCHEMA_FILE=schema.tql
TYPEDB_SEED_FILE=seed.tql

# Set to true to force database recreation and schema/seed reload on container restart
# Useful when you've updated schema.tql or seed.tql
FORCE_REINIT=false

# TypeDB credentials
# ⚠️ Change these in production!
TYPEDB_ADMIN_PASSWORD=password123
TYPEDB_USER_NAME=admin
TYPEDB_USER_PASSWORD=password123

# =============================================================================
# AUTHENTIK IDENTITY PROVIDER
# Authentik provides OAuth2/OIDC authentication for the application
# =============================================================================

# Authentik database (PostgreSQL)
AUTHENTIK_PG_DB=authentik
AUTHENTIK_PG_USER=authentik
# ⚠️ REQUIRED: Generate with: openssl rand -base64 36
AUTHENTIK_PG_PASS=changeme-generate-secure-password

# Authentik secret key
# ⚠️ REQUIRED: Generate with: openssl rand -base64 36
AUTHENTIK_SECRET_KEY=changeme-generate-secure-secret-key

# Authentik URLs - IMPORTANT: There are TWO different URLs needed!
#
# AUTHENTIK_URL (Internal): Used by backend to fetch OIDC metadata from Authentik
# - In Docker: Leave unset to use default (http://authentik-server:9000)
# - Outside Docker: Set to http://localhost:9000
# ⚠️ DO NOT set this in Docker unless you know what you're doing!
# AUTHENTIK_URL=http://authentik-server:9000  # Docker default (set in docker-compose.base.yml)
#
# AUTHENTIK_EXTERNAL_URL: How users access Authentik in their browser
AUTHENTIK_EXTERNAL_URL=http://localhost:9000

# OAuth2 Application Settings
# These are obtained from Authentik admin UI after creating an OAuth2 Provider
# 1. Log into Authentik admin: http://localhost:9000/if/admin/
# 2. Create an OAuth2 Provider for K-BAAS-2
# 3. Create an Application and link it to the provider
# 4. Copy the Client ID and Client Secret here
AUTHENTIK_CLIENT_ID=
AUTHENTIK_CLIENT_SECRET=

# AUTHENTIK_ISSUER: The issuer URL that appears in JWT tokens
# This MUST match what Authentik puts in the 'iss' claim of tokens
# Usually the external URL + application path
AUTHENTIK_ISSUER=http://localhost:9000/application/o/k-baas-2/
AUTHENTIK_APP_SLUG=k-baas-2

# Frontend Authentik settings (VITE_ prefix for browser exposure)
# These use the EXTERNAL URL since they run in the user's browser
VITE_AUTHENTIK_URL=http://localhost:9000
VITE_AUTHENTIK_CLIENT_ID=

# =============================================================================
# API KEYS (Optional - for AI features when implemented)
# =============================================================================
# OPENAI_API_KEY=your_api_key_here

# JWT Secret for internal token signing (if not using Authentik for everything)
# ⚠️ Change in production!
JWT_SECRET_KEY=dev-secret-key-change-in-production

# =============================================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# =============================================================================
# 1. Copy this file to .env.production
# 2. Update URLs to use your production domain:
#    - VITE_BACKEND_URL=https://api.yourdomain.com
#    - AUTHENTIK_EXTERNAL_URL=https://auth.yourdomain.com
#    - AUTHENTIK_ISSUER=https://auth.yourdomain.com/application/o/k-baas-2/
#    - VITE_AUTHENTIK_URL=https://auth.yourdomain.com
# 3. Set APP_ENV=production and DEBUG=false
# 4. Use your deployment platform (Dokploy, Portainer, etc.) to set secrets:
#    - AUTHENTIK_SECRET_KEY
#    - AUTHENTIK_PG_PASS
#    - TYPEDB_ADMIN_PASSWORD
#    - TYPEDB_USER_PASSWORD
#    - JWT_SECRET_KEY
# 5. Do NOT put secrets in .env.production - that file can be committed